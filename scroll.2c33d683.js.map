{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,8EAOMC,EAAeC,SAASC,cAAc,gBACtCC,EAAgBF,SAASC,cAAc,YACvCE,EAAgBH,SAASC,cAAc,SACvCG,EAAgBJ,SAASC,cAAc,c,SAO9BI,I,OAAAA,EAAfC,EAAAT,EAAA,CAAAS,EAAAC,GAAAC,MAAA,SAAAC,EAAmCC,G,IAcvBC,E,8EAZRC,OAAOC,iBAAiB,SAAUC,GAClCJ,EAAMK,iBACNC,EAAAC,QAAQC,OAAOC,EAAIT,EAAMU,OAAOC,SAASC,YAAYC,MAAMC,OAC3DR,EAAAC,QAAQC,OAAOO,KAAO,EACtBvB,EAAcwB,UAAY,GACM,IAA5BV,EAAAC,QAAQC,OAAOC,EAAEQ,OAAY,C,sBAC/BrB,EAAAsB,GAASC,OAAOC,KAAK,kD,iCAGvB1B,EAAc2B,UAAUC,IAAI,aAC5B7B,EAAc4B,UAAUC,IAAI,a,WAEL,EAAAC,EAAAC,cAAalB,EAAAC,S,QAA9BN,EAAMwB,EAAAC,KAAJzB,KACRL,EAAAsB,GAASC,OAAOC,KAAK,oBAAmCO,OAAf1B,EAAK2B,UAAU,aACxDC,EAAiB5B,GACjB6B,EAAgB7B,EAAMK,EAAAC,S,kDAEtBd,EAAc4B,UAAUC,IAAI,aAC5B1B,EAAAsB,GAASC,OAAOC,KACd,4E,yBAGF/B,EAAa0C,Q,8EAxBiBC,MAAAC,KAAAC,U,CAkClC,SAASL,EAAiB5B,GACxB,IAAMkC,EAAsClC,EAAKmC,KANpCC,KAAI,SAAAC,G,OAAQ,EAAAC,EAAAC,SAAiBF,E,IAAOG,KAAK,IAOtDjD,EAAckD,mBAAmB,YAAaP,GAChC,IAAIvC,EAAA+C,GAAJ,CAAmB,aAAc,CAAEC,aAAc,MACvDC,GAAG,sB,CAQb,SAASC,IACP,IAAQC,EAAuBzD,SAC5BC,cAAc,YACdyD,kBAAkBC,wBAFbC,OAIRhD,OAAOiD,SAAS,CACdC,IAAkB,IAAbL,EACLM,SAAU,U,CAId,SAASvB,EAAgB7B,EAAMqD,GACzBrD,EAAK2B,UAAY0B,EAAQ9C,OAAO+C,SAClC9D,EAAc4B,UAAUmC,OAAO,aAE/B9D,EAAc2B,UAAUmC,OAAO,Y,CAInC,SAASpD,IACcd,SAASmE,gBAAgBR,wBAC7BS,OAASpE,SAASmE,gBAAgBE,aAAe,K,WAKrDC,EAAoB5B,MAAAC,KAAAC,U,CAJ/B2B,E,UAIWD,I,OAAAA,EAAfhE,EAAAT,EAAA,CAAAS,EAAAC,GAAAC,MAAA,SAAAC,I,IAGYE,E,kFADRK,EAAAC,QAAQC,OAAOO,MAAQ,E,UACA,EAAAQ,EAAAC,cAAalB,EAAAC,S,WAA9BN,EAAMwB,EAAAC,KAAJzB,MACEmC,KAAKnB,OAAM,C,eACnB,MAAM,IAAI6C,M,OAEZjC,EAAiB5B,GACjB6C,I,kDAEA5C,OAAO6D,oBAAoB,SAAU3D,GACrCX,EAAc4B,UAAUC,IAAI,aAC5B5B,EAAc2B,UAAUmC,OAAO,aAC/B5D,EAAAsB,GAASC,OAAOC,KACd,8DAEFd,EAAAC,QAAQC,OAAOO,KAAO,EACtBrB,EAAc2B,UAAUmC,OAAO,a,2DAjBAxB,MAAAC,KAAAC,U,CA7EnC7C,EAAac,iBAAiB,U,SAKKH,G,OAApBL,EAAmBqC,MAAAC,KAAAC,U,IAHlCxC,EAAcS,iBAAiB,SA4C/B,WACEX,EAAcwB,UAAY,GAC1BtB,EAAc2B,UAAUC,IAAI,Y,IA7C9BpB,OAAOC,iBAAiB,SAAUC,E","sources":["src/scroll.js"],"sourcesContent":["import templateFunction from './templates/template.hbs';\nimport Notiflix from 'notiflix';\nimport { fetchGallery } from './js/gallery-api';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport {options} from './js/options';\n\nconst galeryFormEl = document.querySelector('#search-form');\nconst galleryListEl = document.querySelector('.gallery');\nconst loadMoreBtnEl = document.querySelector('.load');\nconst clearAllBtnEl = document.querySelector('.clear-all');\n\ngaleryFormEl.addEventListener('submit', handleSearchGallery);\n\nclearAllBtnEl.addEventListener('click', clearAll);\nwindow.addEventListener('scroll', endlessScroll);\n\nasync function handleSearchGallery(event) {\n  try {\n    window.addEventListener('scroll', endlessScroll);\n    event.preventDefault();\n    options.params.q = event.target.elements.searchQuery.value.trim();\n    options.params.page = 1;\n    galleryListEl.innerHTML = '';\n    if (options.params.q.length === 0) {\n      Notiflix.Notify.info('you need to enter a word to search for a photo');\n      return;\n    }\n    clearAllBtnEl.classList.add('is-hidden');\n    loadMoreBtnEl.classList.add('is-hidden');\n\n    const { data } = await fetchGallery(options);\n    Notiflix.Notify.info(`Hooray! We found ${data.totalHits} images.`);\n    addImagesGallery(data);\n    checkBtnClasses(data, options);\n  } catch (error) {\n    loadMoreBtnEl.classList.add('is-hidden');\n    Notiflix.Notify.info(\n      'Sorry, there are no images matching your search query. Please try again.'\n    );\n  } finally {\n    galeryFormEl.reset();\n  }\n}\n\nfunction createImagesGallery(items) {\n  return items.map(item => templateFunction(item)).join('');\n}\n\n\n\nfunction addImagesGallery(data) {\n  const addImagesGalery = createImagesGallery(data.hits);\n  galleryListEl.insertAdjacentHTML('beforeend', addImagesGalery);\n  let gallery = new SimpleLightbox('.gallery a', { captionDelay: 250 });\n  gallery.on('show.simplelightbox');\n}\n\nfunction clearAll() {\n  galleryListEl.innerHTML = '';\n  clearAllBtnEl.classList.add('is-hidden');\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 1.5,\n    behavior: 'smooth',\n  });\n}\n\nfunction checkBtnClasses(data, options) {\n  if (data.totalHits > options.params.per_page) {\n    loadMoreBtnEl.classList.remove('is-hidden');\n  } else {\n    clearAllBtnEl.classList.remove('is-hidden');\n  }\n}\n\nfunction endlessScroll() {\n  const documentRect = document.documentElement.getBoundingClientRect();\n  if (documentRect.bottom < document.documentElement.clientHeight + 150){\n    handleLoadMoreScroll()\n  }\n}\n\nasync function handleLoadMoreScroll() {\n  try {    \n    options.params.page += 1;\n    const { data } = await fetchGallery(options);    \n    if (!data.hits.length) {\n      throw new Error();\n    }\n    addImagesGallery(data);\n    smoothScroll();\n  } catch (error) {\n    window.removeEventListener('scroll', endlessScroll);\n    loadMoreBtnEl.classList.add('is-hidden');\n    clearAllBtnEl.classList.remove('is-hidden');\n    Notiflix.Notify.info(\n      \"We're sorry, but you've reached the end of search results.\"\n    );\n    options.params.page = 1;\n    clearAllBtnEl.classList.remove('is-hidden');\n    \n  }\n}"],"names":["$bpxeT","parcelRequire","$5b53d4e451fa0420$var$galeryFormEl","document","querySelector","$5b53d4e451fa0420$var$galleryListEl","$5b53d4e451fa0420$var$loadMoreBtnEl","$5b53d4e451fa0420$var$clearAllBtnEl","$5b53d4e451fa0420$var$_handleSearchGallery","$parcel$interopDefault","$2TvXO","mark","_callee","event","data","window","addEventListener","$5b53d4e451fa0420$var$endlessScroll","preventDefault","$i0xjD","options","params","q","target","elements","searchQuery","value","trim","page","innerHTML","length","$6JpON","Notify","info","classList","add","$gsNEY","fetchGallery","_ctx","sent","concat","totalHits","$5b53d4e451fa0420$var$addImagesGallery","$5b53d4e451fa0420$var$checkBtnClasses","reset","apply","this","arguments","addImagesGalery","hits","map","item","$gQS4W","default","join","insertAdjacentHTML","$5IjG7","captionDelay","on","$5b53d4e451fa0420$var$smoothScroll","cardHeight","firstElementChild","getBoundingClientRect","height","scrollBy","top","behavior","options1","per_page","remove","documentElement","bottom","clientHeight","$5b53d4e451fa0420$var$_handleLoadMoreScroll","$5b53d4e451fa0420$var$handleLoadMoreScroll","Error","removeEventListener"],"version":3,"file":"scroll.2c33d683.js.map"}