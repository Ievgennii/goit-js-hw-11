{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,8EAOMC,EAAeC,SAASC,cAAc,gBACtCC,EAAgBF,SAASC,cAAc,YACvCE,EAAgBH,SAASC,cAAc,SACvCG,EAAgBJ,SAASC,cAAc,c,SAQ9BI,I,OAAAA,EAAfC,EAAAT,EAAA,CAAAS,EAAAC,GAAAC,MAAA,SAAAC,EAAmCC,G,IAWvBC,E,kFATRC,OAAOC,iBAAiB,SAAUC,GAClCJ,EAAMK,iBACNC,EAAAC,QAAQC,OAAOC,EAAIT,EAAMU,OAAOC,SAASC,YAAYC,MAAMC,OAC3DR,EAAAC,QAAQC,OAAOO,KAAO,EACtBvB,EAAcwB,UAAY,GAE1BtB,EAAcuB,UAAUC,IAAI,aAC5BzB,EAAcwB,UAAUC,IAAI,a,WAEL,EAAAC,EAAAC,cAAad,EAAAC,S,WACb,KADjBN,EAAMoB,EAAAC,KAAJrB,MACCsB,WAA+C,IAA5BjB,EAAAC,QAAQC,OAAOC,EAAEe,OAAY,C,uBACvDC,QAAQC,IAAIzB,EAAKsB,WACjB3B,EAAA+B,GAASC,OAAOC,KAAK,4E,2BAGvBjC,EAAA+B,GAASC,OAAOC,KAAK,oBAAmCC,OAAf7B,EAAKsB,UAAU,aAExDQ,EAAiB9B,GAEjB+B,EAAgB/B,EAAMK,EAAAC,S,kDAEtBd,EAAcwB,UAAUC,IAAI,aAC5BtB,EAAA+B,GAASC,OAAOC,KACd,4E,yBAGFxC,EAAa4C,Q,8EA5BiBC,MAAAC,KAAAC,U,CAsClC,SAASL,EAAiB9B,GACxB,IAAMoC,EAAsCpC,EAAKqC,KANpCC,KAAI,SAAAC,G,OAAQ,EAAAC,EAAAC,SAAiBF,E,IAAOG,KAAK,IAOtDnD,EAAcoD,mBAAmB,YAAaP,GAChC,IAAIzC,EAAAiD,GAAJ,CAAmB,aAAc,CAAEC,aAAc,MACvDC,GAAG,sB,CAQb,SAASC,IACP,IAAQC,EAAuB3D,SAC5BC,cAAc,YACd2D,kBAAkBC,wBAFbC,OAIRlD,OAAOmD,SAAS,CACdC,IAAkB,EAAbL,EACLM,SAAU,U,CAId,SAASvB,EAAgB/B,EAAMuD,GACzBvD,EAAKsB,UAAYiC,EAAQhD,OAAOiD,SAClChE,EAAcwB,UAAUyC,OAAO,aAE/BhE,EAAcuB,UAAUyC,OAAO,Y,CAInC,SAAStD,IACcd,SAASqE,gBAAgBR,wBAC7BS,OAAStE,SAASqE,gBAAgBE,aAAe,K,WAMrDC,EAAoB5B,MAAAC,KAAAC,U,CAL/B2B,E,UAKWD,I,OAAAA,EAAflE,EAAAT,EAAA,CAAAS,EAAAC,GAAAC,MAAA,SAAAC,I,IAGYE,E,kFADRK,EAAAC,QAAQC,OAAOO,MAAQ,E,UACA,EAAAI,EAAAC,cAAad,EAAAC,S,WAA9BN,EAAMoB,EAAAC,KAAJrB,MACEqC,KAAKd,OAAM,C,eACnB,MAAM,IAAIwC,M,OAEZjC,EAAiB9B,GAEjB+C,I,kDAEA9C,OAAO+D,oBAAoB,SAAU7D,GACrCX,EAAcwB,UAAUC,IAAI,aAC5BxB,EAAcuB,UAAUyC,OAAO,aAC/B9D,EAAA+B,GAASC,OAAOC,KACd,8DAEFvB,EAAAC,QAAQC,OAAOO,KAAO,EACtBrB,EAAcuB,UAAUyC,OAAO,a,2DAlBAxB,MAAAC,KAAAC,U,CAlFnC/C,EAAac,iBAAiB,U,SAKKH,G,OAApBL,EAAmBuC,MAAAC,KAAAC,U,IAHlC1C,EAAcS,iBAAiB,SAgD/B,WACEX,EAAcwB,UAAY,GAC1BtB,EAAcuB,UAAUC,IAAI,Y,IAjD9BhB,OAAOC,iBAAiB,SAAUC,E","sources":["src/scroll.js"],"sourcesContent":["import templateFunction from './templates/template.hbs';\nimport Notiflix from 'notiflix';\nimport { fetchGallery } from './js/gallery-api';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport {options} from './js/options';\n\nconst galeryFormEl = document.querySelector('#search-form');\nconst galleryListEl = document.querySelector('.gallery');\nconst loadMoreBtnEl = document.querySelector('.load');\nconst clearAllBtnEl = document.querySelector('.clear-all');\n\n\ngaleryFormEl.addEventListener('submit', handleSearchGallery);\n\nclearAllBtnEl.addEventListener('click', clearAll);\nwindow.addEventListener('scroll', endlessScroll);\n\nasync function handleSearchGallery(event) {\n  try {\n    window.addEventListener('scroll', endlessScroll);\n    event.preventDefault();\n    options.params.q = event.target.elements.searchQuery.value.trim();\n    options.params.page = 1;\n    galleryListEl.innerHTML = '';\n    \n    clearAllBtnEl.classList.add('is-hidden');\n    loadMoreBtnEl.classList.add('is-hidden');\n\n    const { data } = await fetchGallery(options);\n    if (data.totalHits === 0 || options.params.q.length === 0) {\n      console.log(data.totalHits)\n      Notiflix.Notify.info('Sorry, there are no images matching your search query. Please try again.');\n      return;\n    }\n    Notiflix.Notify.info(`Hooray! We found ${data.totalHits} images.`);\n    \n    addImagesGallery(data);\n    \n    checkBtnClasses(data, options);\n  } catch (error) {\n    loadMoreBtnEl.classList.add('is-hidden');\n    Notiflix.Notify.info(\n      'Sorry, there are no images matching your search query. Please try again.'\n    );\n  } finally {\n    galeryFormEl.reset();\n  }\n}\n\nfunction createImagesGallery(items) {\n  return items.map(item => templateFunction(item)).join('');\n}\n\n\n\nfunction addImagesGallery(data) {\n  const addImagesGalery = createImagesGallery(data.hits);\n  galleryListEl.insertAdjacentHTML('beforeend', addImagesGalery);\n  let gallery = new SimpleLightbox('.gallery a', { captionDelay: 250 });\n  gallery.on('show.simplelightbox');\n}\n\nfunction clearAll() {\n  galleryListEl.innerHTML = '';\n  clearAllBtnEl.classList.add('is-hidden');\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction checkBtnClasses(data, options) {\n  if (data.totalHits > options.params.per_page) {\n    loadMoreBtnEl.classList.remove('is-hidden');\n  } else {\n    clearAllBtnEl.classList.remove('is-hidden');\n  }\n}\n\nfunction endlessScroll() {\n  const documentRect = document.documentElement.getBoundingClientRect();\n  if (documentRect.bottom < document.documentElement.clientHeight + 150){\n    handleLoadMoreScroll()\n  }\n  // handleLoadMoreScroll()\n}\n\nasync function handleLoadMoreScroll() {\n  try {    \n    options.params.page += 1;\n    const { data } = await fetchGallery(options);    \n    if (!data.hits.length) {\n      throw new Error();\n    }\n    addImagesGallery(data);\n    // gallery.refresh('show.simplelightbox');\n    smoothScroll();\n  } catch (error) {\n    window.removeEventListener('scroll', endlessScroll);\n    loadMoreBtnEl.classList.add('is-hidden');\n    clearAllBtnEl.classList.remove('is-hidden');\n    Notiflix.Notify.info(\n      \"We're sorry, but you've reached the end of search results.\"\n    );\n    options.params.page = 1;\n    clearAllBtnEl.classList.remove('is-hidden');\n    \n  }\n}"],"names":["$bpxeT","parcelRequire","$5b53d4e451fa0420$var$galeryFormEl","document","querySelector","$5b53d4e451fa0420$var$galleryListEl","$5b53d4e451fa0420$var$loadMoreBtnEl","$5b53d4e451fa0420$var$clearAllBtnEl","$5b53d4e451fa0420$var$_handleSearchGallery","$parcel$interopDefault","$2TvXO","mark","_callee","event","data","window","addEventListener","$5b53d4e451fa0420$var$endlessScroll","preventDefault","$i0xjD","options","params","q","target","elements","searchQuery","value","trim","page","innerHTML","classList","add","$gsNEY","fetchGallery","_ctx","sent","totalHits","length","console","log","$6JpON","Notify","info","concat","$5b53d4e451fa0420$var$addImagesGallery","$5b53d4e451fa0420$var$checkBtnClasses","reset","apply","this","arguments","addImagesGalery","hits","map","item","$gQS4W","default","join","insertAdjacentHTML","$5IjG7","captionDelay","on","$5b53d4e451fa0420$var$smoothScroll","cardHeight","firstElementChild","getBoundingClientRect","height","scrollBy","top","behavior","options1","per_page","remove","documentElement","bottom","clientHeight","$5b53d4e451fa0420$var$_handleLoadMoreScroll","$5b53d4e451fa0420$var$handleLoadMoreScroll","Error","removeEventListener"],"version":3,"file":"scroll.3869bd99.js.map"}